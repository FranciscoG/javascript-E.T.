<!DOCTYPE html>
<html class="no-js"> 
    <head>
        <meta charset="utf-8">
       
        <title>Sprite Test</title>
        <style type="text/css">
          .br { height: 20px;} 
        </style>
    </head>
    <body>
      <canvas id="cv" width="320" height="192"></canvas>
      <div class="br"></div>
      <canvas id="cv2" width="320" height="192"></canvas>

      <script src="../../assets/sprites.js"></script>
      <script src="../../dist/vcs.js"></script>
      <script>
        'use strict';
        /*****************************************
         * setup canvases
         */
        
        var cv = document.getElementById('cv');
        var ctx = cv.getContext("2d");
        ctx.fillStyle = "#000";

        var scale = 2;

        // cv.width = cv.width * scale;
        // cv.height = cv.height * scale;
        ctx.scale(scale * 2,scale * 2); // only scales what's placed on the canvas
        ctx.webkitImageSmoothingEnabled = false;
        ctx.mozImageSmoothingEnabled = false;
        ctx.imageSmoothingEnabled = false;

        /************************************************
         * create images off screen using drawer.js lib
         */
        
        var options = {
          color: "#fce08c"
        };

        var ET_walkA = [
          vcs.draw(ETWalkSprite_A0, options),
          vcs.draw(ETWalkSprite_A1, options),
          vcs.draw(ETWalkSprite_A2, options),
        ];

        var ET_walkB = [
          vcs.draw(ETWalkSprite_B0, options),
          vcs.draw(ETWalkSprite_B1, options),
          vcs.draw(ETWalkSprite_B2, options)
        ];

        var ET_title = [
          vcs.draw(TitleETGraphics_1, options),
          vcs.draw(TitleETGraphics_2, options),
          vcs.draw(TitleETGraphics_3, options),
          vcs.draw(TitleETGraphics_4, options),
          vcs.draw(TitleETGraphics_5, options),
          vcs.draw(TitleETGraphics_0, options)
        ];


        /**************************************************
         * Walking Player animation sprite
         */

        // this loops through each walk image and puts it on the screen
        var _i = 0;
        function doWalk(){
          ctx.fillRect(0, 0, cv.width, cv.height);
          ctx.drawImage(ET_walkA[_i], 20, 20);
          ctx.drawImage(ET_walkB[_i], 40, 20);
          _i++;
          if (_i > 2) {_i = 0;}
        }

        // using requestAnimationFrame to make it walk
        var framesToSkip = 5, counter = 0;

        function loop() {
          if (counter < framesToSkip) {
              counter++;
              requestAnimationFrame(loop);
              return;
          }
          doWalk();
          counter = 0;
          requestAnimationFrame(loop);
        }

        loop();

        /**************************************************
         * Title Screen ET
         */
        
        var cv2 = document.getElementById('cv2');
        var ctx2 = cv2.getContext("2d");
        ctx2.fillStyle = "#000";

        cv2.width = cv2.width * scale;
        cv2.height = cv2.height * scale;
        ctx2.scale(scale * 2,scale * 2); // only scales what's placed on the canvas
        ctx2.webkitImageSmoothingEnabled = false;
        ctx2.mozImageSmoothingEnabled = false;
        ctx2.imageSmoothingEnabled = false;

        function showTitle(){
          ctx2.fillRect(0, 0, cv2.width, cv2.height);

          // Move registration point to the center of the canvas
          ctx2.save();
          
          ctx2.translate(cv2.width/4, cv2.height/4);
          // Rotate 180 degree
          ctx2.rotate(180*(Math.PI/180));

          var x = 0;
          var y = 0;
          ctx2.drawImage(ET_title[0], x, y);
          ctx2.drawImage(ET_title[1], x + (8), y);
          ctx2.drawImage(ET_title[2], x + (8*2), y);
          ctx2.drawImage(ET_title[3], x + (8*3), y);
          ctx2.drawImage(ET_title[4], x + (8*4), y);
          ctx2.drawImage(ET_title[5], x + (8*5), y);

          var ET_E = vcs.draw(ETTitle_E, options);
          var ET_T = vcs.draw(ETTitle_T, options);
          ctx2.drawImage(ET_E, 0, 50);
          ctx2.drawImage(ET_T, 25, 50);

          ctx2.restore();
        }

        showTitle();


      </script>

    </body>
</html>
